use super::{constants::*, gfp, gfp12, gfp2, gfp6};
use core::mem::size_of;

pub fn entry() {
    test_memory_alignments();
    test_multi_batch_gfp_mul();
    test_gfp_one_and_zero();
    test_gfp_mul_with_carry();
    test_gfp_add();
    test_gfp_sub();
    test_gfp_sub_with_carry();
    test_gfp_neg();
    test_gfp_invert();
    test_gfp_sqrt();
    test_gfp_mont_encode_decode();
    test_gfp2_conjugate();
    test_gfp2_mul();
    test_gfp2_mul_scalar();
    test_gfp2_mul_xi();
    test_gfp2_square();
    test_gfp2_invert();
    test_gfp6_mul();
    test_gfp6_add();
    test_gfp6_mul_tau();
    test_gfp6_frobenius();
    test_gfp6_square();
    test_gfp6_invert();
    test_gfp12_mul();
    test_gfp12_conjugate();
    test_gfp12_frobenius();
    test_gfp12_square();
    test_gfp12_set_one();
    test_gfp12_exp();
    test_gfp12_invert();
    test_gfp12_final_exponentiation();
}

pub fn test_memory_alignments() {
    assert_eq!(size_of::<gfp::Gfp>(), 32);
    assert_eq!(size_of::<gfp2::Gfp2>(), 64);
    assert_eq!(size_of::<gfp6::Gfp6>(), 192);
    assert_eq!(size_of::<gfp12::Gfp12>(), 384);
    assert_eq!(size_of::<[gfp::Gfp; 64]>(), 32 * 64);
    assert_eq!(size_of::<[gfp2::Gfp2; 8]>(), 64 * 8);
    assert_eq!(size_of::<[gfp6::Gfp6; 15]>(), 192 * 15);
    assert_eq!(size_of::<[gfp12::Gfp12; 3]>(), 384 * 3);
}

pub fn test_multi_batch_gfp_mul() {
    let a = gfp::Gfp([
        11250488846250692438,
        4656389213572280514,
        123,
        8950588588633063607,
    ]);
    let b = gfp::Gfp([
        1755467536201717349,
        17175472035685840286,
        12281294985516866593,
        10355184993929758713,
    ]);

    let aa: [gfp::Gfp; 53] = [
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
    ];

    let bb: [gfp::Gfp; 53] = [
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
    ];

    let mut cc: [gfp::Gfp; 53] = [
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
    ];

    gfp::mul(&aa, &bb, &mut cc);

    let c = gfp::Gfp([
        15559124068522268778,
        4388294418392014253,
        13026942575419976433,
        9224681250169400588,
    ]);

    for i in 0..53 {
        assert_eq!(cc[i], c);
    }
}

pub fn test_gfp_one_and_zero() {
    assert_eq!(gfp::ONE, gfp::Gfp::new_from_int64(1));
    assert_eq!(gfp::ZERO, gfp::Gfp::new_from_int64(0));
}

pub fn test_gfp_mul_with_carry() {
    let a = gfp::Gfp([
        0x9c21c3ff7e444f56,
        0x409ed151b2efb0c2,
        0x7c36e0e62c2380b7,
        0xFFFFFFFFFFFFFFFE,
    ]);
    let b = gfp::Gfp([
        0x185cac6c5e089665,
        0xee5b88d120b5b59e,
        0xaa6fecb86184dc21,
        0xFFFFFFFFFFFFFFFE,
    ]);

    let c = a * b;

    assert_eq!(
        c,
        gfp::Gfp([
            8285319100095743200,
            10296293173922742217,
            6548902816963158894,
            10996926879179715675,
        ])
    );
}

pub fn test_gfp_add() {
    let a = gfp::Gfp([
        11250488846250692438,
        4656389213572280514,
        123,
        8950588588633063607,
    ]);
    let b = gfp::Gfp([
        1755467536201717349,
        17175472035685840286,
        213721987,
        10355184993929758713,
    ]);

    let c = a + b;

    assert_eq!(
        c,
        gfp::Gfp([
            11250488846250692436,
            4656389213572280514,
            6165449088406407133,
            8950588588633063606,
        ])
    );
}

pub fn test_gfp_sub() {
    let a = gfp::Gfp([
        11250488846250692438,
        4656389213572280514,
        8950588588633063607,
        123,
    ]);
    let b = gfp::Gfp([
        1755467536201717349,
        17175472035685840286,
        213721987,
        10355184993929758713,
    ]);

    let c = a - b;

    assert_eq!(
        c,
        gfp::Gfp([
            11250488846250692440,
            4656389213572280514,
            2785139500226656597,
            124
        ])
    );
}

pub fn test_gfp_sub_with_carry() {
    let a = gfp::Gfp([
        12914221971125705348,
        16869266043372738742,
        2352150371692796467,
        6148399054240367173,
    ]);
    let b = gfp::Gfp([
        1750705067395732211,
        14145462954298357320,
        10130208651646123803,
        11833318026314460232,
    ]);

    let c = a - b;

    assert_eq!(
        c,
        gfp::Gfp([
            12918984439931690488,
            1452531051050670092,
            4503236705563539258,
            4670266021855665654
        ])
    );
}

pub fn test_gfp_neg() {
    let a = gfp::Gfp([
        11250488846250692438,
        4656389213572280514,
        8950588588633063607,
        123,
    ]);
    let b = gfp::Gfp([
        1755467536201717349,
        17175472035685840286,
        213721987,
        10355184993929758713,
    ]);

    assert_eq!(
        (-a),
        gfp::Gfp([
            8951722763660576529,
            12519082822113559771,
            3330706396883802986,
            10355184993929758590
        ])
    );

    assert_eq!((-b), gfp::Gfp([2, 0, 12281294985303144606, 0]));
}

pub fn test_gfp_invert() {
    let mut a = gfp::Gfp([
        11250488846250692438,
        4656389213572280514,
        8950588588633063607,
        123,
    ]);
    a.invert();

    assert_eq!(
        a,
        gfp::Gfp([
            5773649162373703676,
            376681799751688925,
            2825795984682414485,
            9194822151192441938
        ])
    );
}

pub fn test_gfp_sqrt() {
    let mut b = gfp::Gfp([
        1755467536201717349,
        17175472035685840286,
        213721987,
        10355184993929758713,
    ]);
    b.sqrt();

    assert_eq!(
        b,
        gfp::Gfp([
            16445677904934073556,
            4460622770300838374,
            15941605659616619718,
            2666621848948930475
        ])
    );
}

pub fn test_gfp_mont_encode_decode() {
    let mut c = [gfp::Gfp([
        16445677904934073556,
        4460622770300838374,
        15941605659616619718,
        2666621848948930475,
    ])];
    let mut c2 = c.clone();

    gfp::mont_encode(&mut c);
    assert_eq!(
        c[0],
        gfp::Gfp([
            9624780884217287538,
            5996517144107171957,
            5822160666522832865,
            5212132491394613704
        ])
    );

    gfp::mont_decode(&mut c2);
    assert_eq!(
        c2[0],
        gfp::Gfp([
            10658238715199466746,
            1200261570185971627,
            16649185520430610962,
            10253963333291830384
        ])
    );
}

pub fn test_gfp2_conjugate() {
    let mut b = gfp2::Gfp2([
        gfp::Gfp([
            11250488846250692438,
            4656389213572280514,
            8950588588633063607,
            123,
        ]),
        gfp::Gfp([
            1755467536201717349,
            17175472035685840286,
            213721987,
            10355184993929758713,
        ]),
    ]);
    b.conjugate();
    assert_eq!(
        b,
        gfp2::Gfp2([
            gfp::Gfp([
                8951722763660576529,
                12519082822113559771,
                3330706396883802986,
                10355184993929758590
            ]),
            gfp::Gfp([
                1755467536201717349,
                17175472035685840286,
                213721987,
                10355184993929758713
            ]),
        ])
    )
}

pub fn test_gfp2_mul() {
    let mut a = gfp2::Gfp2([
        gfp::Gfp([123123123, 432432523, 12343432423, 5234543534]),
        gfp::Gfp([
            16045690984833335023,
            188899839028173,
            72057594037927935,
            320263130583841,
        ]),
    ]);
    let b = gfp2::Gfp2([
        gfp::Gfp([
            11250488846250692438,
            4656389213572280514,
            8950588588633063607,
            123,
        ]),
        gfp::Gfp([
            1755467536201717349,
            17175472035685840286,
            213721987,
            10355184993929758713,
        ]),
    ]);
    a.mul_ref(&b);
    assert_eq!(
        a,
        gfp2::Gfp2([
            gfp::Gfp([
                2489387057500270750,
                1327558915820720488,
                14258554181724279548,
                7728970882490758084
            ]),
            gfp::Gfp([
                16350727825498422601,
                9698509411976742198,
                13143318885643114834,
                8969178055545188830
            ]),
        ])
    )
}

pub fn test_gfp2_mul_scalar() {
    let mut a = gfp2::Gfp2([
        gfp::Gfp([123123123, 432432523, 12343432423, 5234543534]),
        gfp::Gfp([
            16045690984833335023,
            188899839028173,
            72057594037927935,
            320263130583841,
        ]),
    ]);
    let b = gfp2::Gfp2([
        gfp::Gfp([
            11250488846250692438,
            4656389213572280514,
            8950588588633063607,
            123,
        ]),
        gfp::Gfp([
            1755467536201717349,
            17175472035685840286,
            213721987,
            10355184993929758713,
        ]),
    ]);
    a.mul_scalar(b.x());
    assert_eq!(
        a,
        gfp2::Gfp2([
            gfp::Gfp([
                14721675226523201950,
                18190855699907848119,
                10139236777107793065,
                8752730092639463160
            ]),
            gfp::Gfp([
                10210682578032766731,
                591857751552811498,
                14628815490910629706,
                6936890750848109067
            ]),
        ])
    )
}

pub fn test_gfp2_mul_xi() {
    let mut a = gfp2::Gfp2([
        gfp::Gfp([123123123, 432432523, 12343432423, 5234543534]),
        gfp::Gfp([
            16045690984833335023,
            188899839028173,
            72057594037927935,
            320263130583841,
        ]),
    ]);
    a.mul_xi();
    assert_eq!(
        a,
        gfp2::Gfp2([
            gfp::Gfp([
                16045690985202704392,
                188901136325742,
                72057631068225204,
                320278834214443
            ]),
            gfp::Gfp([
                11243584806957778714,
                566699084651998,
                216172769770351382,
                960784157207989
            ]),
        ])
    )
}

pub fn test_gfp2_square() {
    let mut a = gfp2::Gfp2([
        gfp::Gfp([123123123, 432432523, 12343432423, 5234543534]),
        gfp::Gfp([
            16045690984833335023,
            188899839028173,
            72057594037927935,
            320263130583841,
        ]),
    ]);
    a.square();
    assert_eq!(
        a,
        gfp2::Gfp2([
            gfp::Gfp([
                11531738038236630210,
                13126667805834787204,
                18112355732282690172,
                2273042299983030315
            ]),
            gfp::Gfp([
                7110594916861888900,
                4154062045572080677,
                10875259129568976175,
                5353020417179791541
            ]),
        ])
    )
}

pub fn test_gfp2_invert() {
    let mut a = gfp2::Gfp2([
        gfp::Gfp([123123123, 432432523, 12343432423, 5234543534]),
        gfp::Gfp([
            16045690984833335023,
            188899839028173,
            72057594037927935,
            320263130583841,
        ]),
    ]);
    a.invert();
    assert_eq!(
        a,
        gfp2::Gfp2([
            gfp::Gfp([
                3911113778245031709,
                16268145991669920417,
                16013053519776358408,
                66489236252843360
            ]),
            gfp::Gfp([
                8539473088330600381,
                15068154429679669105,
                5918236881039899774,
                6959643544030151944
            ]),
        ])
    );
}

pub fn test_gfp6_mul() {
    let mut a = gfp6::Gfp6([
        gfp2::Gfp2([
            gfp::Gfp([
                13299466320820322921,
                1334898321389508150,
                777638192576573,
                2462001644565870981,
            ]),
            gfp::Gfp([
                6178297660766082928,
                6935407640177199,
                994915640430261047,
                9610997237968299987,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                10235539899642369522,
                12741543848394976843,
                2570526805555943005,
                7178211257522399554,
            ]),
            gfp::Gfp([
                8385329653617091970,
                4658593967506428941,
                7397673696024808282,
                10215112591710322060,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                17555722496412720078,
                7611710049214149191,
                9429613433644166354,
                12877982462025580053,
            ]),
            gfp::Gfp([
                9195465710963449424,
                5119449261756289138,
                4129100919611997905,
                15613499668096370617,
            ]),
        ]),
    ]);
    let b = gfp6::Gfp6([
        gfp2::Gfp2([
            gfp::Gfp([
                1251516497924237659,
                8800572147407667607,
                16894469218369778120,
                2201283438199553284,
            ]),
            gfp::Gfp([
                7385237905993026785,
                9664522640730925348,
                4949129250769697840,
                15765341227729135176,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                10790664886325667451,
                4954645195844557409,
                4872797328446812687,
                18415687177023613778,
            ]),
            gfp::Gfp([
                1100268829278832980,
                11295635979670006245,
                2531060017928703546,
                693690534599138220,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                3282165258555545034,
                12297410556422710010,
                11436677084181775060,
                594813352432006914,
            ]),
            gfp::Gfp([
                14552417674827158111,
                5666874473208417209,
                15164209493867543632,
                14869847932673707334,
            ]),
        ]),
    ]);
    a.mul_ref(&b);
    assert_eq!(
        a,
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    11250023141042085337,
                    8164665131851436433,
                    4237901628673596059,
                    2597336722362054735
                ]),
                gfp::Gfp([
                    17848783536020225926,
                    16823195710109576046,
                    7971232726808812427,
                    182986990994140376
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    9894692318664580025,
                    8676310028740166243,
                    18387579812175980292,
                    8536163994985583961
                ]),
                gfp::Gfp([
                    17914707192985647523,
                    17522501282041289216,
                    4135469977621712572,
                    1742338172306569816
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    2302682184198593166,
                    13504791764439463528,
                    17326728935197664395,
                    1001428737599459846
                ]),
                gfp::Gfp([
                    11913370879433313614,
                    9637933627311996513,
                    4474444391886026868,
                    4489855072906659958
                ]),
            ]),
        ]),
    )
}

pub fn test_gfp6_add() {
    let mut a = gfp6::Gfp6([
        gfp2::Gfp2([
            gfp::Gfp([
                13299466320820322921,
                1334898321389508150,
                777638192576573,
                2462001644565870981,
            ]),
            gfp::Gfp([
                6178297660766082928,
                6935407640177199,
                994915640430261047,
                9610997237968299987,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                10235539899642369522,
                12741543848394976843,
                2570526805555943005,
                7178211257522399554,
            ]),
            gfp::Gfp([
                8385329653617091970,
                4658593967506428941,
                7397673696024808282,
                10215112591710322060,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                17555722496412720078,
                7611710049214149191,
                9429613433644166354,
                12877982462025580053,
            ]),
            gfp::Gfp([
                9195465710963449424,
                5119449261756289138,
                4129100919611997905,
                15613499668096370617,
            ]),
        ]),
    ]);
    let b = gfp6::Gfp6([
        gfp2::Gfp2([
            gfp::Gfp([
                1251516497924237659,
                8800572147407667607,
                16894469218369778120,
                2201283438199553284,
            ]),
            gfp::Gfp([
                7385237905993026785,
                9664522640730925348,
                4949129250769697840,
                15765341227729135176,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                10790664886325667451,
                4954645195844557409,
                4872797328446812687,
                18415687177023613778,
            ]),
            gfp::Gfp([
                1100268829278832980,
                11295635979670006245,
                2531060017928703546,
                693690534599138220,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                3282165258555545034,
                12297410556422710010,
                11436677084181775060,
                594813352432006914,
            ]),
            gfp::Gfp([
                14552417674827158111,
                5666874473208417209,
                15164209493867543632,
                14869847932673707334,
            ]),
        ]),
    ]);
    a.add_ref(&b);
    assert_eq!(
        a,
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    14550982818744560580,
                    10135470468797175757,
                    16895246856562354693,
                    4663285082765424265
                ]),
                gfp::Gfp([
                    11808068030557392362,
                    10942730086394813877,
                    12109493979392643909,
                    15021153471767676449
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    823993176056768006,
                    520717008553693967,
                    13608773222195440715,
                    15238713440616254618
                ]),
                gfp::Gfp([
                    7730130946694207599,
                    17225501985200146516,
                    16094182802146196850,
                    553618132379701566
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    635676145056996145,
                    2733648569951018916,
                    8584995532309074821,
                    3117610820527828254
                ]),
                gfp::Gfp([
                    3545671775879338568,
                    12057595772988417678,
                    7012015427962674943,
                    1681418533130767622
                ]),
            ]),
        ]),
    )
}

pub fn test_gfp6_mul_tau() {
    let mut a = gfp6::Gfp6([
        gfp2::Gfp2([
            gfp::Gfp([
                13299466320820322921,
                1334898321389508150,
                777638192576573,
                2462001644565870981,
            ]),
            gfp::Gfp([
                6178297660766082928,
                6935407640177199,
                994915640430261047,
                9610997237968299987,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                10235539899642369522,
                12741543848394976843,
                2570526805555943005,
                7178211257522399554,
            ]),
            gfp::Gfp([
                8385329653617091970,
                4658593967506428941,
                7397673696024808282,
                10215112591710322060,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                17555722496412720078,
                7611710049214149191,
                9429613433644166354,
                12877982462025580053,
            ]),
            gfp::Gfp([
                9195465710963449424,
                5119449261756289138,
                4129100919611997905,
                15613499668096370617,
            ]),
        ]),
    ]);
    a.mul_tau();
    assert_eq!(
        a,
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    10235539899642369522,
                    12741543848394976843,
                    2570526805555943005,
                    7178211257522399554
                ]),
                gfp::Gfp([
                    8385329653617091970,
                    4658593967506428941,
                    7397673696024808282,
                    10215112591710322060
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    17555722496412720078,
                    7611710049214149191,
                    9429613433644166354,
                    12877982462025580053
                ]),
                gfp::Gfp([
                    9195465710963449424,
                    5119449261756289138,
                    4129100919611997905,
                    15613499668096370617
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    7427740939606231108,
                    5282902409832412981,
                    7162697643200675788,
                    6641817177736154216
                ]),
                gfp::Gfp([
                    1724491589074491161,
                    1228451977578446107,
                    15314867459483576612,
                    5660620081479511552
                ]),
            ]),
        ]),
    )
}

pub fn test_gfp6_frobenius() {
    let a = gfp6::Gfp6([
        gfp2::Gfp2([
            gfp::Gfp([
                13299466320820322921,
                1334898321389508150,
                777638192576573,
                2462001644565870981,
            ]),
            gfp::Gfp([
                6178297660766082928,
                6935407640177199,
                994915640430261047,
                9610997237968299987,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                10235539899642369522,
                12741543848394976843,
                2570526805555943005,
                7178211257522399554,
            ]),
            gfp::Gfp([
                8385329653617091970,
                4658593967506428941,
                7397673696024808282,
                10215112591710322060,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                17555722496412720078,
                7611710049214149191,
                9429613433644166354,
                12877982462025580053,
            ]),
            gfp::Gfp([
                9195465710963449424,
                5119449261756289138,
                4129100919611997905,
                15613499668096370617,
            ]),
        ]),
    ]);

    let mut b = a.clone();
    b.frobenius();
    assert_eq!(
        b,
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    9486454764309019532,
                    15153722087040825797,
                    14148130962263916270,
                    9766789264927033992
                ]),
                gfp::Gfp([
                    13825501170980227946,
                    14191973401669480257,
                    6577473672838478977,
                    7535298712779835580
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    10604673199905043352,
                    4048006646768974666,
                    12580038342680802998,
                    6356288891102824263
                ]),
                gfp::Gfp([
                    8341407740215589966,
                    2012167331039729841,
                    4066038874610911575,
                    2368225386989106381
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    891021577296831538,
                    10835034024495402424,
                    9017130640065385261,
                    5568761611683971562
                ]),
                gfp::Gfp([
                    9195465710963449424,
                    5119449261756289138,
                    4129100919611997905,
                    15613499668096370617
                ]),
            ]),
        ]),
    );

    let mut b = a.clone();
    b.frobenius_p2();
    assert_eq!(
        b,
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    671355457934989443,
                    5640316228974086885,
                    5675934534301149227,
                    5162272224294475370
                ]),
                gfp::Gfp([
                    2210863133664432197,
                    11694897798834615665,
                    16764050774757246121,
                    1749759953746667953
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    17893870032509732352,
                    16193188582259353659,
                    1955174483545948995,
                    7957384075146779003
                ]),
                gfp::Gfp([
                    10347084670917460318,
                    975262961153909817,
                    7323505486685457515,
                    4523693076367985786
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    17555722496412720078,
                    7611710049214149191,
                    9429613433644166354,
                    12877982462025580053
                ]),
                gfp::Gfp([
                    9195465710963449424,
                    5119449261756289138,
                    4129100919611997905,
                    15613499668096370617
                ])
            ])
        ]),
    );

    let mut b = a.clone();
    b.frobenius_p4();
    assert_eq!(
        b,
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    6231389831155956603,
                    10200257485322245250,
                    6604582813023140793,
                    2730911125069412362
                ]),
                gfp::Gfp([
                    13568518351682471193,
                    4202366791187336091,
                    6803623555846226019,
                    9349612796144549486
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    12275013287670436060,
                    5416211640717350068,
                    1590144608222289570,
                    5574774655190338870
                ]),
                gfp::Gfp([
                    3225264821578434030,
                    10270343069001790197,
                    9841410788323467390,
                    5971564319781209580
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    17555722496412720078,
                    7611710049214149191,
                    9429613433644166354,
                    12877982462025580053
                ]),
                gfp::Gfp([
                    9195465710963449424,
                    5119449261756289138,
                    4129100919611997905,
                    15613499668096370617
                ])
            ])
        ]),
    );
}

pub fn test_gfp6_square() {
    let mut a = gfp6::Gfp6([
        gfp2::Gfp2([
            gfp::Gfp([
                13299466320820322921,
                1334898321389508150,
                777638192576573,
                2462001644565870981,
            ]),
            gfp::Gfp([
                6178297660766082928,
                6935407640177199,
                994915640430261047,
                9610997237968299987,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                10235539899642369522,
                12741543848394976843,
                2570526805555943005,
                7178211257522399554,
            ]),
            gfp::Gfp([
                8385329653617091970,
                4658593967506428941,
                7397673696024808282,
                10215112591710322060,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                17555722496412720078,
                7611710049214149191,
                9429613433644166354,
                12877982462025580053,
            ]),
            gfp::Gfp([
                9195465710963449424,
                5119449261756289138,
                4129100919611997905,
                15613499668096370617,
            ]),
        ]),
    ]);
    a.square();
    assert_eq!(
        a,
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    1625878822368296212,
                    7137752418852243982,
                    7852957785461502495,
                    7369034017538948284
                ]),
                gfp::Gfp([
                    14259755805398656720,
                    9845563553125731804,
                    7575013111229715700,
                    9246172451541013788
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    8615873930212783731,
                    16049024658177027544,
                    3438286798177779660,
                    2819070065053580653
                ]),
                gfp::Gfp([
                    5992994943314345619,
                    702908699682906562,
                    674728541751200454,
                    2894939989035206828
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    9045448392753589614,
                    11317548171030416388,
                    13664940548098455938,
                    5537277176179613232
                ]),
                gfp::Gfp([
                    18331098019258749780,
                    4302773911054862658,
                    9263938645333819930,
                    10001562297875888661
                ])
            ])
        ]),
    )
}

pub fn test_gfp6_invert() {
    let mut a = gfp6::Gfp6([
        gfp2::Gfp2([
            gfp::Gfp([
                13299466320820322921,
                1334898321389508150,
                777638192576573,
                2462001644565870981,
            ]),
            gfp::Gfp([
                6178297660766082928,
                6935407640177199,
                994915640430261047,
                9610997237968299987,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                10235539899642369522,
                12741543848394976843,
                2570526805555943005,
                7178211257522399554,
            ]),
            gfp::Gfp([
                8385329653617091970,
                4658593967506428941,
                7397673696024808282,
                10215112591710322060,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                17555722496412720078,
                7611710049214149191,
                9429613433644166354,
                12877982462025580053,
            ]),
            gfp::Gfp([
                9195465710963449424,
                5119449261756289138,
                4129100919611997905,
                15613499668096370617,
            ]),
        ]),
    ]);
    a.invert();
    assert_eq!(
        a,
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    3618770177939589780,
                    8954217812839919346,
                    14725093990967079947,
                    494515057757056009
                ]),
                gfp::Gfp([
                    9169902377195679024,
                    10714198027339945674,
                    7350331450767891164,
                    8517253350348643059
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    2384633948016454087,
                    15887189693557135927,
                    8650595963873417222,
                    7236448062565438870
                ]),
                gfp::Gfp([
                    17654211289079118180,
                    13892215106504858285,
                    14059897362215882305,
                    6201997492044943516
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    15872923883347334976,
                    18250961755378066424,
                    7766166681217046917,
                    7740187268675792967
                ]),
                gfp::Gfp([
                    2284786759662035730,
                    18083933148000867853,
                    1245953157564280853,
                    6345153681553111422
                ])
            ])
        ]),
    )
}

pub fn test_gfp12_mul() {
    let mut a = gfp12::Gfp12([
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    3667846507953887491,
                    16900179788401734972,
                    5202994304093473423,
                    17453539537035408087,
                ]),
                gfp::Gfp([
                    11294849722977086672,
                    6931524454484542999,
                    2919019974606421381,
                    5311781127872492101,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    4588638555648059472,
                    6694620551933342411,
                    14222704463299368988,
                    6283919428323601606,
                ]),
                gfp::Gfp([
                    16935097361277382215,
                    10934062136797373527,
                    13782524259185360576,
                    6099150221451844182,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    16328742311309392122,
                    10884420952720279826,
                    5776584962314197930,
                    2625270159525647960,
                ]),
                gfp::Gfp([
                    1433550955996912027,
                    18308888180603395900,
                    7140845094312883963,
                    12322709745785911983,
                ]),
            ]),
        ]),
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    12958361953211441767,
                    16539242936560925112,
                    496667524947962939,
                    7318576673493474856,
                ]),
                gfp::Gfp([
                    10476768389383674531,
                    6622471593605249540,
                    10868377492823851870,
                    4734272502313788277,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    16513736411768867909,
                    6752337739347602576,
                    7692284702896389678,
                    6427906310226029860,
                ]),
                gfp::Gfp([
                    11804159439800973761,
                    6545976662818114017,
                    16407889771506200374,
                    6607950436195618721,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    12718068223665550407,
                    17958154591785256186,
                    9808583071101047895,
                    17976942195457119028,
                ]),
                gfp::Gfp([
                    11592890871196578403,
                    49657635944967790,
                    6201219735826930191,
                    16748731094003577462,
                ]),
            ]),
        ]),
    ]);
    let b = gfp12::Gfp12([
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    4503791523885574738,
                    12714759677392939410,
                    16457109345378546204,
                    9171162923222403663,
                ]),
                gfp::Gfp([
                    6969123563248190217,
                    2197926471184818775,
                    10290551532855509325,
                    7770597100190585264,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    10369492585103489498,
                    9424549262311352164,
                    4701824735683997277,
                    4263976124659630181,
                ]),
                gfp::Gfp([
                    1569754957210513865,
                    106637851768697756,
                    14648840659876738437,
                    6619828509513455733,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    10164860806937296078,
                    428966593719761762,
                    16600637139761291264,
                    5787507821847875483,
                ]),
                gfp::Gfp([
                    12951650004466072273,
                    9550678619841911114,
                    2421366227307746036,
                    9381991486618438145,
                ]),
            ]),
        ]),
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    1232719219505160689,
                    10176903086272498909,
                    8270979242875895831,
                    4772035228700622700,
                ]),
                gfp::Gfp([
                    794178126965929656,
                    8198588332493935106,
                    2272301894777342892,
                    5459079826449810529,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    15634252570378219707,
                    1747853453109060151,
                    13692393608475207339,
                    15299512762118938020,
                ]),
                gfp::Gfp([
                    3420540247969666996,
                    1142833676285372995,
                    16412396317541896942,
                    431962668864690761,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    5024920917484813592,
                    3889787077705029890,
                    6030945393400361870,
                    4882525774182598802,
                ]),
                gfp::Gfp([
                    2365836809404620536,
                    2497223594188346976,
                    2037307941431156442,
                    1816799884863874525,
                ]),
            ]),
        ]),
    ]);

    a.mul_ref(&b);

    assert_eq!(
        a,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        8366288660281840694,
                        17106108931172739834,
                        6474746686240165220,
                        3595716162521594081
                    ]),
                    gfp::Gfp([
                        3888116874868250365,
                        2319634497006608443,
                        16355340153066809673,
                        9316749277605971462
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        821701444971335034,
                        387935053033751094,
                        10530101431840072275,
                        6192720512623185842
                    ]),
                    gfp::Gfp([
                        8770150287726956535,
                        5984454816086749899,
                        9702674870292846421,
                        3730422798055319111
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        7969688685467800334,
                        13873377714099112324,
                        4473088674756021009,
                        5637342244435887236
                    ]),
                    gfp::Gfp([
                        5212754229807570039,
                        5080894109340452647,
                        6407798718385362255,
                        7489333360971400700
                    ])
                ])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        11771724307473966634,
                        5337740371395798810,
                        3828832192875907768,
                        9183939536668641680
                    ]),
                    gfp::Gfp([
                        8836527425709707481,
                        1361654467792037882,
                        14586974585011993760,
                        687694912754996
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        15568034726880053376,
                        1155880020925750283,
                        7273274371831393973,
                        4994271705657926134
                    ]),
                    gfp::Gfp([
                        7796472225537412817,
                        9736824667850677113,
                        8360024178150166016,
                        4217239342809540119
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        597149532245980637,
                        7827972387253570838,
                        4383259446044489068,
                        980491848796822030
                    ]),
                    gfp::Gfp([
                        15376275190762642354,
                        553095530566742872,
                        6775953191013836301,
                        5031344844963270658
                    ])
                ])
            ])
        ]),
    );
}

pub fn test_gfp12_conjugate() {
    let mut a = gfp12::Gfp12([
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    1200738607427826595,
                    7402316604169350460,
                    7099776225306707039,
                    10844354157363405321,
                ]),
                gfp::Gfp([
                    6249849037670393245,
                    7700683037695774817,
                    1252949071294785348,
                    5497601737213329501,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    17298094099783245673,
                    3505412857988577895,
                    9984357687432652001,
                    17165074977985272380,
                ]),
                gfp::Gfp([
                    11389755620203828177,
                    18165221322631691152,
                    1186036074325123127,
                    18020646389712908453,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    17664485266894284038,
                    11800645568340375105,
                    440398395809311413,
                    2200571472482386041,
                ]),
                gfp::Gfp([
                    10832092656638174102,
                    6419334518338815225,
                    4685834323563037160,
                    10533133079932876720,
                ]),
            ]),
        ]),
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    10103022555689855733,
                    11546273070202069856,
                    9891084571862857660,
                    11458196736922730286,
                ]),
                gfp::Gfp([
                    9792355561170932498,
                    14415562811685693639,
                    14587010320354796818,
                    9559774240069771158,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    11963432835322714680,
                    901906754086167148,
                    6444514864419491413,
                    14077625491358624582,
                ]),
                gfp::Gfp([
                    9121101369151049629,
                    9366532330507142765,
                    13887954159132927882,
                    15492668455428059907,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    1157125985010399030,
                    946057778929360904,
                    2902744047494707281,
                    14878521206228668672,
                ]),
                gfp::Gfp([
                    2212574646124309250,
                    2983498739587327246,
                    12440529125600000638,
                    5475741364458216453,
                ]),
            ]),
        ]),
    ]);

    a.conjugate();

    assert_eq!(
        a,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        17246005466281725021,
                        11044427469540201155,
                        11346967848402844576,
                        7602389916346146294
                    ]),
                    gfp::Gfp([
                        13952362572240875722,
                        9474788997990065468,
                        11028345914222081245,
                        4857583256716429212
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        1148649973926305943,
                        14941331215720973720,
                        8462386386276899614,
                        1281669095724279235
                    ]),
                    gfp::Gfp([
                        7056988453505723439,
                        281522751077860463,
                        17260707999384428488,
                        426097683996643162
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        2537726343016984929,
                        5374826467345465180,
                        11840896589707555180,
                        8154613521447372672
                    ]),
                    gfp::Gfp([
                        7614651417071377514,
                        12027409555370736390,
                        13760909750146514455,
                        7913610993776674895
                    ])
                ])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        10103022555689855733,
                        11546273070202069856,
                        9891084571862857660,
                        11458196736922730286
                    ]),
                    gfp::Gfp([
                        9792355561170932498,
                        14415562811685693639,
                        14587010320354796818,
                        9559774240069771158
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        11963432835322714680,
                        901906754086167148,
                        6444514864419491413,
                        14077625491358624582
                    ]),
                    gfp::Gfp([
                        9121101369151049629,
                        9366532330507142765,
                        13887954159132927882,
                        15492668455428059907
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        1157125985010399030,
                        946057778929360904,
                        2902744047494707281,
                        14878521206228668672
                    ]),
                    gfp::Gfp([
                        2212574646124309250,
                        2983498739587327246,
                        12440529125600000638,
                        5475741364458216453
                    ])
                ])
            ])
        ]),
    );
}

pub fn test_gfp12_frobenius() {
    let a = gfp12::Gfp12([
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    2540091735491372862,
                    17939401464932813024,
                    12365716353952963942,
                    9313577543264141305,
                ]),
                gfp::Gfp([
                    3904863308781927924,
                    12954988384832204441,
                    4669090897367472481,
                    2275454918850530387,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    1089785815457616173,
                    11105381979883465698,
                    10997951161518312975,
                    18407770598658596651,
                ]),
                gfp::Gfp([
                    9775384456346270157,
                    8346895887513866421,
                    17536181360332997300,
                    15076295385300114677,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    1804954384654060828,
                    17257384206765060066,
                    16964800555754698337,
                    11921430014515052065,
                ]),
                gfp::Gfp([
                    12065189263169649665,
                    14539046561667851998,
                    16641956302536492107,
                    6857178055762742683,
                ]),
            ]),
        ]),
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    10682687792263788237,
                    11517289179412700367,
                    11366405679546733092,
                    12213298948966542199,
                ]),
                gfp::Gfp([
                    3838374172461667402,
                    6981182677937813815,
                    15634176071265621590,
                    15631487658478181990,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    3152892455745523300,
                    15201925863840175490,
                    9036036148215359795,
                    9420091586457351520,
                ]),
                gfp::Gfp([
                    3449635502369493814,
                    11385008056092574830,
                    14978820178428276186,
                    1424520853186285229,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    5213332717486975346,
                    10162979714695309299,
                    2115577493997682713,
                    3990776349311192470,
                ]),
                gfp::Gfp([
                    11585592628825883278,
                    4164661155874164602,
                    3616995949541952951,
                    11867546317512717308,
                ]),
            ]),
        ]),
    ]);

    let mut b = a.clone();
    b.frobenius();

    assert_eq!(
        b,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        8699860347215723266,
                        2153477773123766431,
                        16122963214378940998,
                        5847464626378166649
                    ]),
                    gfp::Gfp([
                        18428288240250016208,
                        11587491277870081345,
                        12055501711382975061,
                        7142437294237633181
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        14429420588606402106,
                        1739092416961783202,
                        18141546886113807575,
                        10028983015434198718
                    ]),
                    gfp::Gfp([
                        2675203738517704749,
                        13969785309174461780,
                        4919666544968719388,
                        9978405027627170006
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        11572980282387206193,
                        329422984909308640,
                        9470106813241514153,
                        4333105232888603964
                    ]),
                    gfp::Gfp([
                        14940646124547152510,
                        10112052071863849365,
                        9219230943255182704,
                        498777410269012628
                    ])
                ])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        5076567446219440181,
                        3622692958915035889,
                        1591628557368894432,
                        9083153226693629356
                    ]),
                    gfp::Gfp([
                        12273114204423388510,
                        1313500879023357773,
                        5863902587488520139,
                        10348662782406924624
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        13028717029366196474,
                        199877403344351373,
                        15658791131106145466,
                        4838472579632215513
                    ]),
                    gfp::Gfp([
                        3083397889679265388,
                        14772062492456533775,
                        2996800162523628880,
                        7244888107256240611
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        14988878892424293621,
                        7012492320990530986,
                        10165717491519183880,
                        6364408644618566243
                    ]),
                    gfp::Gfp([
                        11585592628825883278,
                        4164661155874164602,
                        3616995949541952951,
                        11867546317512717308
                    ])
                ])
            ])
        ]),
    );

    let mut b = a.clone();
    b.frobenius_p2();

    assert_eq!(
        b,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        4092534151119027893,
                        4181683930478739564,
                        1462467400710877973,
                        6169415951576237512
                    ]),
                    gfp::Gfp([
                        5445318580016305769,
                        16835297996026187541,
                        8022069713272020754,
                        1069529017622440500
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        2421149256945818529,
                        4798818017778663258,
                        13564638809515420212,
                        2302599389200920775
                    ]),
                    gfp::Gfp([
                        12182294689766716161,
                        7557304110148262534,
                        7026408610700735887,
                        5634074602559402749
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        487304140416522458,
                        1766234417965256981,
                        2408974648998695994,
                        2890574061623441999
                    ]),
                    gfp::Gfp([
                        8878233024071212522,
                        11754782660792902839,
                        11646728560123135271,
                        2271954633082004765
                    ])
                ])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        15227830490183627310,
                        4634298323877440206,
                        10082068990610255285,
                        9703437750725177378
                    ]),
                    gfp::Gfp([
                        18200126467226517358,
                        10097561662603179985,
                        17886820907756209244,
                        3538266096581448830
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        12350125363209629067,
                        10424639217496083533,
                        516523898966430424,
                        1971605282918588744
                    ]),
                    gfp::Gfp([
                        9477596300640631028,
                        2030540651604346585,
                        6481069088640940925,
                        9316778913551833239
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        5213332717486975346,
                        10162979714695309299,
                        2115577493997682713,
                        3990776349311192470
                    ]),
                    gfp::Gfp([
                        11585592628825883278,
                        4164661155874164602,
                        3616995949541952951,
                        11867546317512717308
                    ])
                ])
            ])
        ]),
    );

    let mut b = a.clone();
    b.frobenius_p4();

    assert_eq!(
        b,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        3307909951829372382,
                        3417754501231766826,
                        1378046032274780624,
                        7211023402241854920
                    ]),
                    gfp::Gfp([
                        3295922807436095196,
                        2609037573170271770,
                        15634273801421414867,
                        9149259092701668826
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        17781062352965450438,
                        12376654017907177027,
                        17163400249710997997,
                        8052585604728837937
                    ]),
                    gfp::Gfp([
                        8019916920144552806,
                        9618167925537577751,
                        5254886374816130706,
                        4721110391370355964
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        437817291964178981,
                        1684322246886037201,
                        16172213152470415866,
                        1324329041038148646
                    ]),
                    gfp::Gfp([
                        17015255370812831824,
                        14391208134810891126,
                        7286067243103509757,
                        5769961571249020795
                    ])
                ])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        16249372473576839738,
                        16928084530057828667,
                        15395410286393611403,
                        9148818282097556562
                    ]),
                    gfp::Gfp([
                        18365922580134353174,
                        17272199730830686770,
                        9488337065721453968,
                        1540616232799886605
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        6454661327157833951,
                        8724378990035421548,
                        15010029923851942967,
                        9318673118483577162
                    ]),
                    gfp::Gfp([
                        9030447343102861476,
                        2488651289965207540,
                        3102700703964516076,
                        9969070221121398958
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        5213332717486975346,
                        10162979714695309299,
                        2115577493997682713,
                        3990776349311192470
                    ]),
                    gfp::Gfp([
                        11585592628825883278,
                        4164661155874164602,
                        3616995949541952951,
                        11867546317512717308
                    ])
                ])
            ])
        ]),
    );
}

pub fn test_gfp12_square() {
    let mut a = gfp12::Gfp12([
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    12013964555163908444,
                    14808224985058352287,
                    1109622207511886178,
                    2163829597263389089,
                ]),
                gfp::Gfp([
                    15462344539966982376,
                    15860511715763341453,
                    10796102638708924854,
                    9160528212763630316,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    9230553043770376978,
                    14590420944516343587,
                    3647604995917619863,
                    10661433637246210138,
                ]),
                gfp::Gfp([
                    11027707307454385488,
                    8935044016936919433,
                    1206720226933526692,
                    11119109011542323539,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    14345626474937423966,
                    4995898206283640812,
                    4727335655662835081,
                    7582985496562311864,
                ]),
                gfp::Gfp([
                    7237746903774961920,
                    10264174104393136159,
                    14057008237834512233,
                    18406957594997086400,
                ]),
            ]),
        ]),
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    14666489105234269300,
                    6479729233028719753,
                    14415648667425913570,
                    7833215564897041680,
                ]),
                gfp::Gfp([
                    15351478629902753896,
                    2675514514706354007,
                    6563202427173723264,
                    10125359277617620713,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    8228495515815198636,
                    2581152349600076717,
                    7723648549634355631,
                    14092602960836499446,
                ]),
                gfp::Gfp([
                    12219212636961089196,
                    5612519539782909016,
                    14346915990666392071,
                    12849095521220052274,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    17030197118220851176,
                    15950168293981915745,
                    3209207552624782567,
                    6138130834479014469,
                ]),
                gfp::Gfp([
                    11760264985868654620,
                    13494511671195195811,
                    1731268550352891606,
                    13004927149277904969,
                ]),
            ]),
        ]),
    ]);

    a.square();

    assert_eq!(
        a,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        17006421432967838929,
                        17427845560760317828,
                        18417609474571383702,
                        8575502755260079644
                    ]),
                    gfp::Gfp([
                        13798159589652760468,
                        2905345290307007778,
                        3153440769747253794,
                        9850820457559018786
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        7035406489789930118,
                        5019887970633007231,
                        10416650611936536874,
                        5188078490195386179
                    ]),
                    gfp::Gfp([
                        4808456183749129106,
                        12446454361756438648,
                        15733928763825820410,
                        919349344475499245
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        13581505369658051084,
                        2725902279293965176,
                        4279619295184787873,
                        8623788268271587527
                    ]),
                    gfp::Gfp([
                        16744974594390622263,
                        4691077012359608677,
                        821293552850855739,
                        9961099537659135554
                    ])
                ])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        6219776072410688521,
                        3854051837607176631,
                        14328490777669780476,
                        9278836366979810645
                    ]),
                    gfp::Gfp([
                        10494286857144740067,
                        7262731545420274421,
                        162555339361434183,
                        8369200555830661532
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        1046531506687502884,
                        13906759918862353988,
                        4038190663097413374,
                        7581444125744635397
                    ]),
                    gfp::Gfp([
                        16511446469702165860,
                        7392670263314143767,
                        9676980851712153444,
                        461819701357828537
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        17491183406219310955,
                        8402664453922682974,
                        6612389990049929711,
                        3833202121168496930
                    ]),
                    gfp::Gfp([
                        10026507007075137426,
                        2023705499039943470,
                        17646252746307055670,
                        3528382195922251337
                    ])
                ])
            ])
        ]),
    );
}

pub fn test_gfp12_set_one() {
    let mut a = gfp12::Gfp12::default();

    a.set_one();

    assert_eq!(
        a,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([gfp::Gfp([0, 0, 0, 0]), gfp::Gfp([0, 0, 0, 0])]),
                gfp2::Gfp2([gfp::Gfp([0, 0, 0, 0]), gfp::Gfp([0, 0, 0, 0])]),
                gfp2::Gfp2([gfp::Gfp([0, 0, 0, 0]), gfp::Gfp([0, 0, 0, 0])])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([gfp::Gfp([0, 0, 0, 0]), gfp::Gfp([0, 0, 0, 0])]),
                gfp2::Gfp2([gfp::Gfp([0, 0, 0, 0]), gfp::Gfp([0, 0, 0, 0])]),
                gfp2::Gfp2([
                    gfp::Gfp([0, 0, 0, 0]),
                    gfp::Gfp([
                        16691276537507834265,
                        1271272038023711329,
                        6165449088192685022,
                        8091559079779792902
                    ])
                ])
            ])
        ]),
    );
}

pub fn test_gfp12_exp() {
    let a = gfp12::Gfp12([
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    2760854596168266245,
                    410463285507609942,
                    5808811169668198877,
                    1231434299195455327,
                ]),
                gfp::Gfp([
                    12539326288993413451,
                    7230102318714495996,
                    6175423893401558442,
                    12552398646939532562,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    13847355747305046471,
                    18035394755073131576,
                    14716059516811992387,
                    17298059062978978072,
                ]),
                gfp::Gfp([
                    14814000269195625255,
                    16019272932637147212,
                    11870502691384086143,
                    1748016208695954959,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    2360485602362089510,
                    4767942490500515749,
                    1811006171205652137,
                    12805227344479373306,
                ]),
                gfp::Gfp([
                    3856970609803968254,
                    14744349334461188564,
                    3625655944335533978,
                    6362168537177977431,
                ]),
            ]),
        ]),
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    16025877046109649582,
                    9162468457068905976,
                    4754865801877286228,
                    17829856008257169458,
                ]),
                gfp::Gfp([
                    17720004535151947133,
                    7925931852233220954,
                    6369529217214369496,
                    289515257519070562,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    3316649591130426859,
                    16930025258184827104,
                    17412146179602036838,
                    8153833287786406609,
                ]),
                gfp::Gfp([
                    2993656467732856105,
                    2597052809218258109,
                    1291561376524301388,
                    7289663831724079283,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    16173192029740623481,
                    8641253715140851162,
                    11276469769874247410,
                    6736317593609620499,
                ]),
                gfp::Gfp([
                    8061985468569285658,
                    3520382789643729060,
                    15432080361893575328,
                    8031767377836413680,
                ]),
            ]),
        ]),
    ]);

    let mut b = a.clone();
    b.exp(&U.into());

    assert_eq!(
        b,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        10113851244375416064,
                        3226874029671622414,
                        16402967706007092461,
                        5597792147345149484
                    ]),
                    gfp::Gfp([
                        3053602579803778786,
                        14789590343994763386,
                        8052648266070798376,
                        8499773539004014261
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        7319170960377750419,
                        14314567967545161500,
                        7004905109391922422,
                        8343264159710318479
                    ]),
                    gfp::Gfp([
                        16478882832793586539,
                        9698958777406921786,
                        8845019632625307022,
                        7001121626709352204
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        13265100309198425445,
                        18068243522957503815,
                        9061783889011490707,
                        4445335329620169423
                    ]),
                    gfp::Gfp([
                        6526750016883697435,
                        571511299605152184,
                        207555342931363523,
                        6327988842309652592
                    ])
                ])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        1158913300529877277,
                        17934995989227947860,
                        9331338558410215326,
                        2595994460783361252
                    ]),
                    gfp::Gfp([
                        1579928687880968414,
                        16141632244579374553,
                        6831306069297138707,
                        2132897761039216118
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        5203555705926969737,
                        9311315773518228399,
                        14322339145645769535,
                        4542333360067269398
                    ]),
                    gfp::Gfp([
                        11295076250513093168,
                        10938632004894226524,
                        7073637711189887949,
                        10031535686749629114
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        3045018719230694443,
                        17655956302474818182,
                        13337545814952945385,
                        1767799073422504614
                    ]),
                    gfp::Gfp([
                        8682451205890787757,
                        11992247842612006250,
                        7267268429587149408,
                        3225716774847686340
                    ])
                ])
            ])
        ]),
    );

    let mut b = a.clone();
    b.exp(&P.into());

    assert_eq!(
        b,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        12415841162914530173,
                        15167168088220108341,
                        264242658061919211,
                        2710044584083373284
                    ]),
                    gfp::Gfp([
                        13802012258652197499,
                        7812162709302442418,
                        4616276778376756917,
                        5908261297920761280
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        1788494479564907132,
                        13695649166563084854,
                        1049714682710036925,
                        9251929991772113085
                    ]),
                    gfp::Gfp([
                        15279248311282524394,
                        3933674978049752891,
                        4014221188750686343,
                        2642252001502263505
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        16509575977507639775,
                        5652238364620594060,
                        12758390173669463386,
                        6219091984487849406
                    ]),
                    gfp::Gfp([
                        1035017084146897691,
                        7712817772480594817,
                        11520893060627367928,
                        8362263724828163001
                    ])
                ])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        495570992928569537,
                        904353314593885439,
                        10284486665229088700,
                        5876707188808050368
                    ]),
                    gfp::Gfp([
                        291132851533213838,
                        13063704878805687767,
                        16357908523288368051,
                        4201229599741390764
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        8665452317798119085,
                        17144615647318758644,
                        12413779127562706282,
                        9219305626190007659
                    ]),
                    gfp::Gfp([
                        15886302567050006221,
                        15782636696240625348,
                        1242581556547722680,
                        3789449505847271866
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        1591626703582220712,
                        16517289150593257828,
                        8211786738353609275,
                        6766158292414049320
                    ]),
                    gfp::Gfp([
                        14522332141235687355,
                        7997370115579634997,
                        12360919212190235072,
                        9182097743829469930
                    ])
                ])
            ])
        ]),
    );
}

pub fn test_gfp12_invert() {
    let mut a = gfp12::Gfp12([
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    3702521411267253021,
                    7621017602715785083,
                    10515675354853576244,
                    16061257574491263946,
                ]),
                gfp::Gfp([
                    13246403283566668357,
                    6278601434117996239,
                    8470336559517429431,
                    5165237833527017499,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    3915783333221709023,
                    9396757186147650852,
                    13571938040877398443,
                    1211123242567068557,
                ]),
                gfp::Gfp([
                    3205296117816546925,
                    573996504562857903,
                    18038155607945121651,
                    6746211784919906039,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    18321394568411648414,
                    2252990237045041341,
                    11139743789895915444,
                    4682425594689700926,
                ]),
                gfp::Gfp([
                    15577255483354407395,
                    12884731292459412005,
                    4504149958318612297,
                    14937639976797079102,
                ]),
            ]),
        ]),
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    2872765196343209357,
                    16562866521258992653,
                    11127195412902892416,
                    15930148612935619283,
                ]),
                gfp::Gfp([
                    3969876043819577967,
                    6568996827661532343,
                    3380590671303250911,
                    3645187030083852383,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    3006638927424339067,
                    10170704767908667087,
                    11327758573597514170,
                    190312375687676664,
                ]),
                gfp::Gfp([
                    11543097111886165151,
                    17650040256097916603,
                    16096266359355108837,
                    2316874018151529765,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    1750705067395732211,
                    14145462954298357320,
                    10130208651646123803,
                    11833318026314460232,
                ]),
                gfp::Gfp([
                    12914221971125705348,
                    16869266043372738742,
                    2352150371692796467,
                    6148399054240367173,
                ]),
            ]),
        ]),
    ]);

    a.invert();

    assert_eq!(
        a,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        8725530784669236444,
                        4086840915016544040,
                        11221391724010107545,
                        8365734404475279410
                    ]),
                    gfp::Gfp([
                        5191491924211732974,
                        16173759774583565755,
                        307610399190927908,
                        4056414725256850131
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        2750294504509396201,
                        15079737708157457395,
                        84372602703133142,
                        3970015652387939007
                    ]),
                    gfp::Gfp([
                        1064620314609833285,
                        12744602340600586810,
                        2484391161929600442,
                        8060842072431500363
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        10280222771389079732,
                        10927325090910148587,
                        14479014244236312671,
                        9172341407628457404
                    ]),
                    gfp::Gfp([
                        15027048458829482346,
                        10943818669861157863,
                        1284991097285655976,
                        2812257799434638677
                    ])
                ])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        14430266411514507865,
                        11160638895855157305,
                        7693658773263557990,
                        1891214393518398906
                    ]),
                    gfp::Gfp([
                        16748204535361658973,
                        4723395938016804217,
                        8667265327983459392,
                        4799142189519611722
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        2490546554527189616,
                        11113267187223846355,
                        10565395284671169651,
                        6778314741893605496
                    ]),
                    gfp::Gfp([
                        8562254502422390764,
                        12682457714982065489,
                        16487641858441271450,
                        7113881273935670330
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        11574048334820174262,
                        18162694698134431211,
                        2697903362600446380,
                        4372787533303594577
                    ]),
                    gfp::Gfp([
                        2534567728783475487,
                        1407648892423740080,
                        1611098686317639968,
                        7616619113524350704
                    ])
                ])
            ])
        ]),
    );
}

pub fn test_gfp12_final_exponentiation() {
    let mut a = gfp12::Gfp12([
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    7746766703602913940,
                    11360091731651817881,
                    614867342588151215,
                    13057466358222241307,
                ]),
                gfp::Gfp([
                    4278102385313880904,
                    1726431602035059881,
                    9291684235232712277,
                    10669372499334009279,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    17942984381384860030,
                    8265035295865313410,
                    11277804159794482514,
                    18012043940718815442,
                ]),
                gfp::Gfp([
                    6511557839754508117,
                    1734873027154322923,
                    13336621245943127009,
                    18206717104351994306,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    8808966976438088055,
                    1747251114086766858,
                    7637315157468345479,
                    12882734362385908721,
                ]),
                gfp::Gfp([
                    14624822495559609504,
                    2285424135128241092,
                    17978941597603262057,
                    18368039613021768059,
                ]),
            ]),
        ]),
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    820838582750976347,
                    26121997494692088,
                    14214361807949837977,
                    5427035684968308990,
                ]),
                gfp::Gfp([
                    2998383564885790829,
                    14926256864544452592,
                    15953336672024481204,
                    16223070253164746453,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    5149318025704139988,
                    4009019813136834896,
                    12818843079192757572,
                    18045877544016578188,
                ]),
                gfp::Gfp([
                    12682403905542053164,
                    15755813220272629588,
                    9270328695821323581,
                    10780969897608746889,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    10521933486382254155,
                    932883561855861337,
                    5772159629299006018,
                    15181848843322432853,
                ]),
                gfp::Gfp([
                    7049433074070288894,
                    207768344213459201,
                    15988219164456317273,
                    3470391652697892466,
                ]),
            ]),
        ]),
    ]);

    a.final_exponentiation();

    assert_eq!(
        a,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        1209675210185975846,
                        11603044566122610963,
                        15673510266862886728,
                        7166442817774629600
                    ]),
                    gfp::Gfp([
                        1096501857325391923,
                        1768478092178716103,
                        5467137770519099390,
                        2999129621428050299
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        15940584763415482399,
                        3513101931460257996,
                        15326547810967606640,
                        6050713642273863674
                    ]),
                    gfp::Gfp([
                        11075662083349037442,
                        9137426301727849326,
                        17986063879311810592,
                        5337575004113272640
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        7100066149093643525,
                        7510073558198035470,
                        3645941936529663754,
                        3822772998464106381
                    ]),
                    gfp::Gfp([
                        1730348902124976788,
                        3768835486770440735,
                        12481130426226118016,
                        10201337152422172443
                    ])
                ])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        18382614237176044337,
                        6524820635731445751,
                        12403212192603796761,
                        8624979402877878939
                    ]),
                    gfp::Gfp([
                        2294380990736470959,
                        13090508610506088056,
                        3466619647070115606,
                        1509456272759008284
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        12627482334354940615,
                        12977854193744533955,
                        17774385966466028836,
                        1692080156492508671
                    ]),
                    gfp::Gfp([
                        12266730357931952751,
                        3134494137666208347,
                        17735743892589984297,
                        5816724766974182460
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        2496384226233182255,
                        5757529286359966133,
                        7475972537717183871,
                        1574257112673551249
                    ]),
                    gfp::Gfp([
                        7480359146886875079,
                        7050295587122493569,
                        6638577955924591371,
                        7158615059748150193
                    ])
                ])
            ])
        ]),
    );
}
